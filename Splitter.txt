import pandas as pd
import plotly.express as px

# --- Load Excel file ---
df = pd.read_excel("your_file.xlsx")

# Clean column names (optional)
df.columns = [c.strip().lower().replace(" ", "_") for c in df.columns]

# --- Create a grouped bar chart with one facet per 'tc' ---
fig = px.bar(
    df,
    x="subtc",
    y=["word_acc", "phrase_acc", "character_acc"],  # 3 accuracy metrics
    facet_col="tc",  # each 'tc' gets its own subplot
    barmode="group",
    color_discrete_sequence=px.colors.qualitative.Set2,
    text_auto=True,
    title="Accuracy Comparison by Task (tc) and Subtask (subtc)",
)

# --- Aesthetic improvements ---
fig.update_layout(
    font=dict(family="Arial", size=14),
    title_x=0.5,
    title_font=dict(size=20, family="Arial Black"),
    legend_title_text="Accuracy Type",
    plot_bgcolor="white",
    paper_bgcolor="white",
    hovermode="x unified",
    bargap=0.15,
    bargroupgap=0.05,
)

# Make subplots neat
fig.for_each_annotation(lambda a: a.update(text=a.text.split("=")[-1]))  # Clean facet labels

# Add gridlines & format y-axis
fig.update_yaxes(showgrid=True, gridwidth=0.5, gridcolor="lightgray", title="Accuracy (%)")
fig.update_xaxes(title="Subtask (subtc)")

# --- Show chart ---
fig.show()
