import React, { useRef, useEffect } from 'react';

const ChatInputBox = ({ inputText, setInputText, handleSendMessage }) => {
  const textareaRef = useRef(null);

  useEffect(() => {
    if (textareaRef.current) {
      textareaRef.current.style.height = 'auto';
      textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`;
    }
  }, [inputText]);

  const handleKeyPress = (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSendMessage();
    }
  };

  const handleInputChange = (e) => {
    setInputText(e.target.value);
  };

  return (
    <div className="relative flex-shrink-0 bg-white border-t border-gray-300 py-4 px-4 sm:px-8">
      <div className="flex w-full mx-auto max-w-4xl">
        <button
          className="flex-shrink-0 mr-2 p-2 rounded-full text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors duration-200"
          aria-label="Attach file"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
          >
            <path d="M21.44 11.02a3.5 3.5 0 0 0-5 5L10 21.44a3.5 3.5 0 0 1-5-5L15.44 5a3.5 3.5 0 0 1 5 5L8.02 18.44a3.5 3.5 0 0 1-5-5L13.44 3a3.5 3.5 0 0 1 5 5L6.02 16.44a3.5 3.5 0 0 1-5-5L11.44 1z" />
          </svg>
        </button>

        <textarea
          ref={textareaRef}
          className="w-full resize-none border border-gray-300 rounded-2xl py-3 px-4 pr-10 text-base leading-6 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all duration-200"
          rows="1"
          value={inputText}
          onChange={handleInputChange}
          onKeyDown={handleKeyPress}
          placeholder="Send a message"
          style={{ minHeight: '48px', maxHeight: '150px' }}
        />

        <button
          onClick={handleSendMessage}
          className="absolute right-6 bottom-6 p-1.5 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed"
          disabled={!inputText.trim()}
          aria-label="Send message"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M19.3479 4.39999C19.7899 4.19599 20.2529 4.41799 20.3549 4.86499L21.8029 11.365C21.9059 11.812 21.6839 12.275 21.2419 12.479L4.39293 20.457C3.95093 20.661 3.48793 20.439 3.38593 19.992L1.93793 13.492C1.83593 13.045 2.05793 12.582 2.49993 12.378L19.3479 4.39999Z"
              fill="currentColor"
            />
          </svg>
        </button>
      </div>
      <div className="text-xs text-gray-500 mt-2">
        <span className="font-semibold">Gemini Advanced</span> can make mistakes. Consider checking important information.
      </div>
    </div>
  );
};

export default ChatInputBox;
