pairs = df.filter(pl.col("rev_flow_id").is_not_null()).select(["flow_id","rev_flow_id"])
# ensure u < v and unique
pairs = pairs.with_columns([
    pl.when(pl.col("flow_id") < pl.col("rev_flow_id")).then(pl.col("flow_id")).otherwise(pl.col("rev_flow_id")).alias("u"),
    pl.when(pl.col("flow_id") < pl.col("rev_flow_id")).then(pl.col("rev_flow_id")).otherwise(pl.col("flow_id")).alias("v"),
]).select(["u","v"]).unique()

pairs.write_parquet("graph/edges_type3.parquet")
