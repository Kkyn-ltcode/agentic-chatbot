if __name__ == '__main__':
    # Load data and generate HTML report on startup
    print("\n" + "="*60)
    print("ğŸš€ Loading data and generating HTML report...")
    print("="*60 + "\n")
    
    data = loader.load_all_data()
    
    if data and not data['summary'].empty:
        html_content = generate_html_report(data)
        
        # Create reports directory if it doesn't exist
        reports_dir = Path("./reports")
        reports_dir.mkdir(exist_ok=True)
        
        # Save HTML report
        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
        report_filename = reports_dir / f"ASR_Report_{timestamp}.html"
        
        with open(report_filename, 'w', encoding='utf-8') as f:
            f.write(html_content)
        
        # Get absolute path
        abs_path = report_filename.resolve()
        
        print("âœ… Report generated successfully!")
        print(f"ğŸ“„ Report saved to: {abs_path}")
        print(f"\nğŸ”— Open in browser:")
        print(f"   file://{abs_path}")
        print("\n" + "="*60)
    else:
        print("âš ï¸  No data found. Please check your data folder.")
        print("="*60 + "\n")
    
    # Start the dashboard server
    print("\nğŸŒ Starting dashboard server...")
    print(f"ğŸ”— Dashboard URL: http://localhost:8050")
    print("   Press CTRL+C to stop\n")
    
    app.run_server(debug=True, host='0.0.0.0', port=8050)
