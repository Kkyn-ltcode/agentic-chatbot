  const chatDisplayRef = useRef(null);
+
+ const isAtBottomRef = useRef(true);
+ const [isAtBottom, setIsAtBottom] = useState(true);
+
+ const handleScroll = () => {
+   const el = chatDisplayRef.current;
+   if (!el) return;
+   const { scrollTop, scrollHeight, clientHeight } = el;
+   const atBottom = scrollHeight - scrollTop <= clientHeight + 20; // tolerance
+   isAtBottomRef.current = atBottom;
+   setIsAtBottom(atBottom);
+ };
