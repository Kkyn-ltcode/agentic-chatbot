from torch.optim.lr_scheduler import LinearLR, CosineAnnealingLR, SequentialLR

# Warmup for first 5 epochs, then cosine decay
warmup_scheduler = LinearLR(
    optimizer, 
    start_factor=0.1,  # Start at 10% of LR
    total_iters=5
)

cosine_scheduler = CosineAnnealingLR(
    optimizer,
    T_max=config['epochs'] - 5,
    eta_min=1e-6
)

scheduler = SequentialLR(
    optimizer,
    schedulers=[warmup_scheduler, cosine_scheduler],
    milestones=[5]
)
