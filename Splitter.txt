df.select([
    pl.col(col).is_nan().any().alias(f"{col}_has_nan")
    for col in df.columns
])
df.select([
    ((pl.col(col) == float("inf")) | (pl.col(col) == float("-inf"))).any().alias(f"{col}_has_inf")
    for col in df.columns
])
